"1.1.21 Ensure sticky bit is set on all world-writable directories" : [FAILED]
Setting the sticky bit on world writable directories prevents users from deleting or renaming files in that directory that are not owned by them.

Rationale:

This feature prevents the ability to delete or rename files in world writable directories (such as /tmp) that are owned by another user.

Remote value: 

The command '/bin/df --local -P | /usr/bin/awk {'if (NR!=1) print $6'} | /usr/bin/xargs -I '{}' /usr/bin/find '{}' -xdev -type d \( -perm -0002 -a ! -perm -1000 \) 2>/dev/null | /usr/bin/awk '{print} END {if (NR == 0) print "none"}'' returned : 

/var/lib/docker/overlay2/9e3095d1de38621f0e65864d830b44ca14ab17464538ea09e9a9a2ae709b4ee1/diff/app/.idea
/var/lib/docker/overlay2/9e3095d1de38621f0e65864d830b44ca14ab17464538ea09e9a9a2ae709b4ee1/diff/app/.idea/inspectionProfiles
/var/lib/docker/overlay2/9e3095d1de38621f0e65864d830b44ca14ab17464538ea09e9a9a2ae709b4ee1/diff/app/.pytest_cache
/var/lib/docker/overlay2/9e3095d1de38621f0e65864d830b44ca14ab17464538ea09e9a9a2ae709b4ee1/diff/app/.pytest_cache/v
/var/lib/docker/overlay2/9e3095d1de38621f0e65864d830b44ca14ab17464538ea09e9a9a2ae709b4ee1/diff/app/.pytest_cache/v/cache
/var/lib/docker/overlay2/9e3095d1de38621f0e65864d830b44ca14ab17464538ea09e9a9a2ae709b4ee1/diff/app/__pycache__
/var/lib/docker/overlay2/9e3095d1de38621f0e65864d830b44ca14ab17464538ea09e9a9a2ae709b4ee1/diff/app/server
/var/lib/docker/overlay2/9e3095d1de38621f0e65864d830b44ca14ab17464538ea09e9a9a2ae709b4ee1/diff/app/server/__pycache__
/var/lib/kubelet/pods/09606e34-0911-422b-b375-3439858f78de/volumes/kubernetes.io~configmap/kube-proxy
/var/lib/kubelet/pods/38455ac3-c9fd-4536-83d5-32407020d3f8/volumes/kubernetes.io~configmap/fluent-bit-config
/data1/minerva-setup/minerva-kubernetes
/data1/minerva-setup/minerva-kubernetes/dialog-config
/data1/minerva-setup/minerva-kubernetes/dialog-config/agent-gateway
/data1/minerva-setup/minerva-kubernetes/dialog-config/agent-management-ms
/data1/minerva-setup/minerva-kubernetes/dialog-config/bot-dialog-ms
/data1/minerva-setup/minerva-kubernetes/dialog-config/bot-management-ms
/data1/minerva-setup/minerva-kubernetes/dialog-config/client-gateway
/data1/minerva-setup/minerva-kubernetes/dialog-config/client-management-ms
/data1/minerva-setup/minerva-kubernetes/dialog-config/css-admin-ui
/data1/minerva-setup/minerva-kubernetes/dialog-config/css-client-ui
/data1/minerva-setup/minerva-kubernetes/dialog-config/customer-service-admin-api
/data1/minerva-setup/minerva-kubernetes/dialog-config/customer-service-api
/data1/minerva-setup/minerva-kubernetes/dialog-config/dialog-engine-ms
/data1/minerva-setup/minerva-kubernetes/dialog-config/dialog-message-ms
/data1/minerva-setup/minerva-kubernetes/dialog-config/dialog-report-ms
/data1/minerva-setup/minerva-kubernetes/dialog-config/dialog-report-pipeline
/data1/minerva-setup/minerva-kubernetes/dialog-config/exp-ms
/data1/minerva-setup/minerva-kubernetes/dialog-config/nlp-ehic-contextual-faq
/data1/minerva-setup/minerva-kubernetes/dialog-config/nlp-ehic-contextual-faq-http-proxy
/data1/minerva-setup/minerva-kubernetes/dialog-config/nlp-elasticsearch
/data1/minerva-setup/minerva-kubernetes/dialog-config/nlp-mla
/data1/minerva-setup/minerva-kubernetes/dialog-config/nlp-mrtv
/data1/minerva-setup/minerva-kubernetes/dialog-config/nlp-pipeline-proxy
/data1/minerva-setup/minerva-kubernetes/dialog-config/nlp-service-pipeline
/data1/minerva-setup/minerva-kubernetes/dialog-config/postgres
/data1/minerva-setup/minerva-kubernetes/dialog-config/rabbitmq
/data1/minerva-setup/minerva-kubernetes/dialog-config/redis
/data1/minerva-setup/minerva-kubernetes/dialog-config/task-dialog-poc-ms
/data1/minerva-setup/minerva-kubernetes/dialog-config-template
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/agent-gateway
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/agent-management-ms
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/bot-dialog-ms
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/bot-management-ms
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/client-gateway
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/client-management-ms
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/css-admin-ui
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/css-client-ui
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/customer-service-admin-api
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/customer-service-api
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/dialog-engine-ms
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/dialog-message-ms
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/dialog-report-ms
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/dialog-report-pipeline
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/exp-ms
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/nlp-ehic-contextual-faq
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/nlp-ehic-contextual-faq-http-proxy
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/nlp-elasticsearch
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/nlp-mla
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/nlp-mrtv
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/nlp-pipeline-proxy
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/nlp-service-pipeline
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/postgres
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/rabbitmq
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/redis
/data1/minerva-setup/minerva-kubernetes/dialog-config-template/task-dialog-poc-ms
/data1/minerva-setup/minerva-kubernetes/env-config
/data1/minerva-setup/minerva-kubernetes/expert-config
/data1/minerva-setup/minerva-kubernetes/expert-config/expert-api
/data1/minerva-setup/minerva-kubernetes/expert-config/expert-ui
/data1/minerva-setup/minerva-kubernetes/expert-config/information-extraction-backend
/data1/minerva-setup/minerva-kubernetes/expert-config/intelligence-backend
/data1/minerva-setup/minerva-kubernetes/expert-config/labeling-ui
/data1/minerva-setup/minerva-kubernetes/expert-config/postgres
/data1/minerva-setup/minerva-kubernetes/expert-config/rabbitmq
/data1/minerva-setup/minerva-kubernetes/expert-config/redis
/data1/minerva-setup/minerva-kubernetes/expert-config-template
/data1/minerva-setup/minerva-kubernetes/expert-config-template/expert-api
/data1/minerva-setup/minerva-kubernetes/expert-config-template/expert-ui
/data1/minerva-setup/minerva-kubernetes/expert-config-template/information-extraction-backend
/data1/minerva-setup/minerva-kubernetes/expert-config-template/intelligence-backend
/data1/minerva-setup/minerva-kubernetes/expert-config-template/labeling-ui
/data1/minerva-setup/minerva-kubernetes/expert-config-template/postgres
/data1/minerva-setup/minerva-kubernetes/expert-config-template/rabbitmq
/data1/minerva-setup/minerva-kubernetes/expert-config-template/redis
/data1/minerva-setup/minerva-kubernetes/identity-config
/data1/minerva-setup/minerva-kubernetes/identity-config/homepage-ui
/data1/minerva-setup/minerva-kubernetes/identity-config/identity-api
/data1/minerva-setup/minerva-kubernetes/identity-config/identity-ui
/data1/minerva-setup/minerva-kubernetes/identity-config/postgres
/data1/minerva-setup/minerva-kubernetes/identity-config/token-mt
/data1/minerva-setup/minerva-kubernetes/identity-config-template
/data1/minerva-setup/minerva-kubernetes/identity-config-template/homepage-ui
/data1/minerva-setup/minerva-kubernetes/identity-config-template/identity-api
/data1/minerva-setup/minerva-kubernetes/identity-config-template/identity-ui
/data1/minerva-setup/minerva-kubernetes/identity-config-template/postgres
/data1/minerva-setup/minerva-kubernetes/identity-config-template/token-mt
/data1/minerva-setup/minerva-kubernetes/image-list
/data1/minerva-setup/minerva-kubernetes/logging-config
/data1/minerva-setup/minerva-kubernetes/logging-config/efk-elasticsearch
/data1/minerva-setup/minerva-kubernetes/logging-config/efk-fluent-bit
/data1/minerva-setup/minerva-kubernetes/logging-config/efk-kibana
/data1/minerva-setup/minerva-kubernetes/logging-config-template
/data1/minerva-setup/minerva-kubernetes/logging-config-template/efk-elasticsearch
/data1/minerva-setup/minerva-kubernetes/logging-config-template/efk-fluent-bit
/data1/minerva-setup/minerva-kubernetes/logging-config-template/efk-kibana
/data1/minerva-setup/nginx/conf.d
/data1/minerva-setup/nginx/log
/data1/minerva-setup/nginx/cert

Solution : 

Run the following command to set the sticky bit on all world writable directories:
# df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type d -perm -0002 2>/dev/null | xargs chmod a+t

See Also : 

https://workbench.cisecurity.org/files/1858

Reference(s) : 

800-53|AC-3,800-171|3.1.1,800-171|3.1.2,CSF|PR.AC-4,CSF|PR.PT-3,ITSG-33|AC-3,CCE|CCE-80130-8,CN-L3|7.1.3.2(b),CN-L3|7.1.3.2(g),LEVEL|1S,PCI-DSSv3.1|7.1.2,PCI-DSSv3.2|7.1.2,SWIFT-CSCv1|5.1
